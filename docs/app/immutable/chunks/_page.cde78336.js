import"./transform.f0a34255.js";import{f as at}from"./helpers.41dfc2ba.js";import{c as ut}from"./csv.41e40aac.js";import{e as ft}from"./extent.4cf1c809.js";import{b as ht,a as ot}from"./ticks.39a2651d.js";import{m as et}from"./max.adfc8a60.js";const ct=lt(dt);function lt(t){return function(n,l,o=l){if(!((l=+l)>=0))throw new RangeError("invalid rx");if(!((o=+o)>=0))throw new RangeError("invalid ry");let{data:e,width:f,height:h}=n;if(!((f=Math.floor(f))>=0))throw new RangeError("invalid width");if(!((h=Math.floor(h!==void 0?h:e.length/f))>=0))throw new RangeError("invalid height");if(!f||!h||!l&&!o)return n;const $=l&&t(l),M=o&&t(o),r=e.slice();return $&&M?(Z($,r,e,f,h),Z($,e,r,f,h),Z($,r,e,f,h),G(M,e,r,f,h),G(M,r,e,f,h),G(M,e,r,f,h)):$?(Z($,e,r,f,h),Z($,r,e,f,h),Z($,e,r,f,h)):M&&(G(M,e,r,f,h),G(M,r,e,f,h),G(M,e,r,f,h)),n}}function Z(t,n,l,o,e){for(let f=0,h=o*e;f<h;)t(n,l,f,f+=o,1)}function G(t,n,l,o,e){for(let f=0,h=o*e;f<o;++f)t(n,l,f,f+h,o)}function dt(t){const n=Math.floor(t);if(n===t)return mt(t);const l=t-n,o=2*t+1;return(e,f,h,$,M)=>{if(!(($-=M)>=h))return;let r=n*f[h];const d=M*n,y=d+M;for(let m=h,D=h+d;m<D;m+=M)r+=f[Math.min($,m)];for(let m=h,D=$;m<=D;m+=M)r+=f[Math.min($,m+d)],e[m]=(r+l*(f[Math.max(h,m-y)]+f[Math.min($,m+y)]))/o,r-=f[Math.max(h,m-d)]}}function mt(t){const n=2*t+1;return(l,o,e,f,h)=>{if(!((f-=h)>=e))return;let $=t*o[e];const M=h*t;for(let r=e,d=e+M;r<d;r+=h)$+=o[Math.min(f,r)];for(let r=e,d=f;r<=d;r+=h)$+=o[Math.min(f,r+M)],l[r]=$/n,$-=o[Math.max(e,r-M)]}}function gt(t,n){let l=0;if(n===void 0)for(let o of t)o!=null&&(o=+o)>=o&&++l;else{let o=-1;for(let e of t)(e=n(e,++o,t))!=null&&(e=+e)>=e&&++l}return l}function Mt(t,n,l){let o;for(;;){const e=ht(t,n,l);if(e===o||e===0||!isFinite(e))return[t,n];e>0?(t=Math.floor(t/e)*e,n=Math.ceil(n/e)*e):e<0&&(t=Math.ceil(t*e)/e,n=Math.floor(n*e)/e),o=e}}function $t(t){return Math.max(1,Math.ceil(Math.log(gt(t))/Math.LN2)+1)}var wt=Array.prototype,st=wt.slice;function yt(t,n){return t-n}function vt(t){for(var n=0,l=t.length,o=t[l-1][1]*t[0][0]-t[l-1][0]*t[0][1];++n<l;)o+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return o}const P=t=>()=>t;function pt(t,n){for(var l=-1,o=n.length,e;++l<o;)if(e=Dt(t,n[l]))return e;return 0}function Dt(t,n){for(var l=n[0],o=n[1],e=-1,f=0,h=t.length,$=h-1;f<h;$=f++){var M=t[f],r=M[0],d=M[1],y=t[$],m=y[0],D=y[1];if(bt(M,y,n))return 0;d>o!=D>o&&l<(m-r)*(o-d)/(D-d)+r&&(e=-e)}return e}function bt(t,n,l){var o;return St(t,n,l)&&Et(t[o=+(t[0]===n[0])],l[o],n[o])}function St(t,n,l){return(n[0]-t[0])*(l[1]-t[1])===(l[0]-t[0])*(n[1]-t[1])}function Et(t,n,l){return t<=n&&n<=l||l<=n&&n<=t}function Ot(){}var F=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function rt(){var t=1,n=1,l=$t,o=M;function e(r){var d=l(r);if(Array.isArray(d))d=d.slice().sort(yt);else{const y=ft(r,At);for(d=ot(...Mt(y[0],y[1],d),d);d[d.length-1]>=y[1];)d.pop();for(;d[1]<y[0];)d.shift()}return d.map(y=>f(r,y))}function f(r,d){const y=d==null?NaN:+d;if(isNaN(y))throw new Error(`invalid value: ${d}`);var m=[],D=[];return h(r,y,function(b){o(b,r,y),vt(b)>0?m.push([b]):D.push(b)}),D.forEach(function(b){for(var x=0,I=m.length,N;x<I;++x)if(pt((N=m[x])[0],b)!==-1){N.push(b);return}}),{type:"MultiPolygon",value:d,coordinates:m}}function h(r,d,y){var m=new Array,D=new Array,b,x,I,N,a,A;for(b=x=-1,N=J(r[0],d),F[N<<1].forEach(O);++b<t-1;)I=N,N=J(r[b+1],d),F[I|N<<1].forEach(O);for(F[N<<0].forEach(O);++x<n-1;){for(b=-1,N=J(r[x*t+t],d),a=J(r[x*t],d),F[N<<1|a<<2].forEach(O);++b<t-1;)I=N,N=J(r[x*t+t+b+1],d),A=a,a=J(r[x*t+b+1],d),F[I|N<<1|a<<2|A<<3].forEach(O);F[N|a<<3].forEach(O)}for(b=-1,a=r[x*t]>=d,F[a<<2].forEach(O);++b<t-1;)A=a,a=J(r[x*t+b+1],d),F[a<<2|A<<3].forEach(O);F[a<<3].forEach(O);function O(L){var z=[L[0][0]+b,L[0][1]+x],k=[L[1][0]+b,L[1][1]+x],H=$(z),S=$(k),c,T;(c=D[H])?(T=m[S])?(delete D[c.end],delete m[T.start],c===T?(c.ring.push(k),y(c.ring)):m[c.start]=D[T.end]={start:c.start,end:T.end,ring:c.ring.concat(T.ring)}):(delete D[c.end],c.ring.push(k),D[c.end=S]=c):(c=m[S])?(T=D[H])?(delete m[c.start],delete D[T.end],c===T?(c.ring.push(k),y(c.ring)):m[T.start]=D[c.end]={start:T.start,end:c.end,ring:T.ring.concat(c.ring)}):(delete m[c.start],c.ring.unshift(z),m[c.start=H]=c):m[H]=D[S]={start:H,end:S,ring:[z,k]}}}function $(r){return r[0]*2+r[1]*(t+1)*4}function M(r,d,y){r.forEach(function(m){var D=m[0],b=m[1],x=D|0,I=b|0,N=tt(d[I*t+x]);D>0&&D<t&&x===D&&(m[0]=it(D,tt(d[I*t+x-1]),N,y)),b>0&&b<n&&I===b&&(m[1]=it(b,tt(d[(I-1)*t+x]),N,y))})}return e.contour=f,e.size=function(r){if(!arguments.length)return[t,n];var d=Math.floor(r[0]),y=Math.floor(r[1]);if(!(d>=0&&y>=0))throw new Error("invalid size");return t=d,n=y,e},e.thresholds=function(r){return arguments.length?(l=typeof r=="function"?r:Array.isArray(r)?P(st.call(r)):P(r),e):l},e.smooth=function(r){return arguments.length?(o=r?M:Ot,e):o===M},e}function At(t){return isFinite(t)?t:NaN}function J(t,n){return t==null?!1:+t>=n}function tt(t){return t==null||isNaN(t=+t)?-1/0:t}function it(t,n,l,o){const e=o-n,f=l-n,h=isFinite(e)||isFinite(f)?e/f:Math.sign(e)/Math.sign(f);return isNaN(h)?t:t+h-.5}function xt(t){return t[0]}function Nt(t){return t[1]}function zt(){return 1}function Tt(){var t=xt,n=Nt,l=zt,o=960,e=500,f=20,h=2,$=f*3,M=o+$*2>>h,r=e+$*2>>h,d=P(20);function y(a){var A=new Float32Array(M*r),O=Math.pow(2,-h),L=-1;for(const g of a){var z=(t(g,++L,a)+$)*O,k=(n(g,L,a)+$)*O,H=+l(g,L,a);if(H&&z>=0&&z<M&&k>=0&&k<r){var S=Math.floor(z),c=Math.floor(k),T=z-S-.5,B=k-c-.5;A[S+c*M]+=(1-T)*(1-B)*H,A[S+1+c*M]+=T*(1-B)*H,A[S+1+(c+1)*M]+=T*B*H,A[S+(c+1)*M]+=(1-T)*B*H}}return ct({data:A,width:M,height:r},f*O),A}function m(a){var A=y(a),O=d(A),L=Math.pow(2,2*h);return Array.isArray(O)||(O=ot(Number.MIN_VALUE,et(A)/L,O)),rt().size([M,r]).thresholds(O.map(z=>z*L))(A).map((z,k)=>(z.value=+O[k],D(z)))}m.contours=function(a){var A=y(a),O=rt().size([M,r]),L=Math.pow(2,2*h),z=k=>{k=+k;var H=D(O.contour(A,k*L));return H.value=k,H};return Object.defineProperty(z,"max",{get:()=>et(A)/L}),z};function D(a){return a.coordinates.forEach(b),a}function b(a){a.forEach(x)}function x(a){a.forEach(I)}function I(a){a[0]=a[0]*Math.pow(2,h)-$,a[1]=a[1]*Math.pow(2,h)-$}function N(){return $=f*3,M=o+$*2>>h,r=e+$*2>>h,m}return m.x=function(a){return arguments.length?(t=typeof a=="function"?a:P(+a),m):t},m.y=function(a){return arguments.length?(n=typeof a=="function"?a:P(+a),m):n},m.weight=function(a){return arguments.length?(l=typeof a=="function"?a:P(+a),m):l},m.size=function(a){if(!arguments.length)return[o,e];var A=+a[0],O=+a[1];if(!(A>=0&&O>=0))throw new Error("invalid size");return o=A,e=O,N()},m.cellSize=function(a){if(!arguments.length)return 1<<h;if(!((a=+a)>=1))throw new Error("invalid cell size");return h=Math.floor(Math.log(a)/Math.LN2),N()},m.thresholds=function(a){return arguments.length?(d=typeof a=="function"?a:Array.isArray(a)?P(st.call(a)):P(a),m):d},m.bandwidth=function(a){if(!arguments.length)return Math.sqrt(f*(f+1));if(!((a=+a)>=0))throw new Error("invalid bandwidth");return f=(Math.sqrt(4*a*a+1)-1)/2,N()},m}const _t=""+new URL("../assets/centenarians_with_expectations.b3299a24.csv",import.meta.url).href;var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nt={},Lt={get exports(){return nt},set exports(t){nt=t}};(function(t,n){(function(l,o){t.exports=o()})(kt,function(){var l=1e3,o=6e4,e=36e5,f="millisecond",h="second",$="minute",M="hour",r="day",d="week",y="month",m="quarter",D="year",b="date",x="Invalid Date",I=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,a={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(g){var u=["th","st","nd","rd"],i=g%100;return"["+g+(u[(i-20)%10]||u[i]||u[0])+"]"}},A=function(g,u,i){var w=String(g);return!w||w.length>=u?g:""+Array(u+1-w.length).join(i)+g},O={s:A,z:function(g){var u=-g.utcOffset(),i=Math.abs(u),w=Math.floor(i/60),s=i%60;return(u<=0?"+":"-")+A(w,2,"0")+":"+A(s,2,"0")},m:function g(u,i){if(u.date()<i.date())return-g(i,u);var w=12*(i.year()-u.year())+(i.month()-u.month()),s=u.clone().add(w,y),p=i-s<0,v=u.clone().add(w+(p?-1:1),y);return+(-(w+(i-s)/(p?s-v:v-s))||0)},a:function(g){return g<0?Math.ceil(g)||0:Math.floor(g)},p:function(g){return{M:y,y:D,w:d,d:r,D:b,h:M,m:$,s:h,ms:f,Q:m}[g]||String(g||"").toLowerCase().replace(/s$/,"")},u:function(g){return g===void 0}},L="en",z={};z[L]=a;var k=function(g){return g instanceof T},H=function g(u,i,w){var s;if(!u)return L;if(typeof u=="string"){var p=u.toLowerCase();z[p]&&(s=p),i&&(z[p]=i,s=p);var v=u.split("-");if(!s&&v.length>1)return g(v[0])}else{var E=u.name;z[E]=u,s=E}return!w&&s&&(L=s),s||!w&&L},S=function(g,u){if(k(g))return g.clone();var i=typeof u=="object"?u:{};return i.date=g,i.args=arguments,new T(i)},c=O;c.l=H,c.i=k,c.w=function(g,u){return S(g,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var T=function(){function g(i){this.$L=H(i.locale,null,!0),this.parse(i)}var u=g.prototype;return u.parse=function(i){this.$d=function(w){var s=w.date,p=w.utc;if(s===null)return new Date(NaN);if(c.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var v=s.match(I);if(v){var E=v[2]-1||0,Y=(v[7]||"0").substring(0,3);return p?new Date(Date.UTC(v[1],E,v[3]||1,v[4]||0,v[5]||0,v[6]||0,Y)):new Date(v[1],E,v[3]||1,v[4]||0,v[5]||0,v[6]||0,Y)}}return new Date(s)}(i),this.$x=i.x||{},this.init()},u.init=function(){var i=this.$d;this.$y=i.getFullYear(),this.$M=i.getMonth(),this.$D=i.getDate(),this.$W=i.getDay(),this.$H=i.getHours(),this.$m=i.getMinutes(),this.$s=i.getSeconds(),this.$ms=i.getMilliseconds()},u.$utils=function(){return c},u.isValid=function(){return this.$d.toString()!==x},u.isSame=function(i,w){var s=S(i);return this.startOf(w)<=s&&s<=this.endOf(w)},u.isAfter=function(i,w){return S(i)<this.startOf(w)},u.isBefore=function(i,w){return this.endOf(w)<S(i)},u.$g=function(i,w,s){return c.u(i)?this[w]:this.set(s,i)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(i,w){var s=this,p=!!c.u(w)||w,v=c.p(i),E=function(V,j){var U=c.w(s.$u?Date.UTC(s.$y,j,V):new Date(s.$y,j,V),s);return p?U:U.endOf(r)},Y=function(V,j){return c.w(s.toDate()[V].apply(s.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(j)),s)},_=this.$W,C=this.$M,R=this.$D,W="set"+(this.$u?"UTC":"");switch(v){case D:return p?E(1,0):E(31,11);case y:return p?E(1,C):E(0,C+1);case d:var Q=this.$locale().weekStart||0,X=(_<Q?_+7:_)-Q;return E(p?R-X:R+(6-X),C);case r:case b:return Y(W+"Hours",0);case M:return Y(W+"Minutes",1);case $:return Y(W+"Seconds",2);case h:return Y(W+"Milliseconds",3);default:return this.clone()}},u.endOf=function(i){return this.startOf(i,!1)},u.$set=function(i,w){var s,p=c.p(i),v="set"+(this.$u?"UTC":""),E=(s={},s[r]=v+"Date",s[b]=v+"Date",s[y]=v+"Month",s[D]=v+"FullYear",s[M]=v+"Hours",s[$]=v+"Minutes",s[h]=v+"Seconds",s[f]=v+"Milliseconds",s)[p],Y=p===r?this.$D+(w-this.$W):w;if(p===y||p===D){var _=this.clone().set(b,1);_.$d[E](Y),_.init(),this.$d=_.set(b,Math.min(this.$D,_.daysInMonth())).$d}else E&&this.$d[E](Y);return this.init(),this},u.set=function(i,w){return this.clone().$set(i,w)},u.get=function(i){return this[c.p(i)]()},u.add=function(i,w){var s,p=this;i=Number(i);var v=c.p(w),E=function(C){var R=S(p);return c.w(R.date(R.date()+Math.round(C*i)),p)};if(v===y)return this.set(y,this.$M+i);if(v===D)return this.set(D,this.$y+i);if(v===r)return E(1);if(v===d)return E(7);var Y=(s={},s[$]=o,s[M]=e,s[h]=l,s)[v]||1,_=this.$d.getTime()+i*Y;return c.w(_,this)},u.subtract=function(i,w){return this.add(-1*i,w)},u.format=function(i){var w=this,s=this.$locale();if(!this.isValid())return s.invalidDate||x;var p=i||"YYYY-MM-DDTHH:mm:ssZ",v=c.z(this),E=this.$H,Y=this.$m,_=this.$M,C=s.weekdays,R=s.months,W=function(j,U,K,q){return j&&(j[U]||j(w,p))||K[U].slice(0,q)},Q=function(j){return c.s(E%12||12,j,"0")},X=s.meridiem||function(j,U,K){var q=j<12?"AM":"PM";return K?q.toLowerCase():q},V={YY:String(this.$y).slice(-2),YYYY:this.$y,M:_+1,MM:c.s(_+1,2,"0"),MMM:W(s.monthsShort,_,R,3),MMMM:W(R,_),D:this.$D,DD:c.s(this.$D,2,"0"),d:String(this.$W),dd:W(s.weekdaysMin,this.$W,C,2),ddd:W(s.weekdaysShort,this.$W,C,3),dddd:C[this.$W],H:String(E),HH:c.s(E,2,"0"),h:Q(1),hh:Q(2),a:X(E,Y,!0),A:X(E,Y,!1),m:String(Y),mm:c.s(Y,2,"0"),s:String(this.$s),ss:c.s(this.$s,2,"0"),SSS:c.s(this.$ms,3,"0"),Z:v};return p.replace(N,function(j,U){return U||V[j]||v.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(i,w,s){var p,v=c.p(w),E=S(i),Y=(E.utcOffset()-this.utcOffset())*o,_=this-E,C=c.m(this,E);return C=(p={},p[D]=C/12,p[y]=C,p[m]=C/3,p[d]=(_-Y)/6048e5,p[r]=(_-Y)/864e5,p[M]=_/e,p[$]=_/o,p[h]=_/l,p)[v]||_,s?C:c.a(C)},u.daysInMonth=function(){return this.endOf(y).$D},u.$locale=function(){return z[this.$L]},u.locale=function(i,w){if(!i)return this.$L;var s=this.clone(),p=H(i,w,!0);return p&&(s.$L=p),s},u.clone=function(){return c.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},g}(),B=T.prototype;return S.prototype=B,[["$ms",f],["$s",h],["$m",$],["$H",M],["$W",r],["$M",y],["$y",D],["$D",b]].forEach(function(g){B[g[1]]=function(u){return this.$g(u,g[0],g[1])}}),S.extend=function(g,u){return g.$i||(g(u,T,S),g.$i=!0),S},S.locale=H,S.isDayjs=k,S.unix=function(g){return S(1e3*g)},S.en=z[L],S.Ls=z,S.p={},S})})(Lt);const Yt=nt,Ht=!0;async function Ct({fetch:t}){return{centenarians:await t(_t).then(n=>n.text()).then(n=>ut(n)).then(n=>{const l={male:1,female:1,abs:1};return n.map(o=>{const e=Math.floor(o.age),f=new Date;return o.still_alive==="alive"?{...o,age:-Yt(o.birth_date).diff(f,"year"),aliveRank:l[o.gender]++,aliveRankAbs:l.abs++}:{...o,age:e}})}),contours:Tt().size([800,800]).cellSize(60).bandwidth(178).thresholds(150).x(({x:n})=>n).y(({y:n})=>n)(at).reverse().map(n=>n.coordinates).flat(2).slice(0,160)}}const Pt=Object.freeze(Object.defineProperty({__proto__:null,load:Ct,prerender:Ht},Symbol.toStringTag,{value:"Module"}));export{Pt as _,Ct as l,Ht as p};
