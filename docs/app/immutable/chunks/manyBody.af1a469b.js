import{n as nt,a as $,d as et,b as Y,c as B,y as rt,p as G}from"./zoom.6f5fd951.js";import{d as V,t as it}from"./transform.f0a34255.js";import{s as H}from"./select.84cbef7e.js";function Yt(t,n){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof n!="function")throw new TypeError("mapper is not a function");return Array.from(t,(e,o)=>n(e,o,t))}const P=t=>()=>t;function F(t,{sourceEvent:n,subject:e,target:o,identifier:i,active:u,x:h,y:c,dx:v,dy:g,dispatch:p}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:v,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:p}})}F.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function ut(t){return!t.ctrlKey&&!t.button}function at(){return this.parentNode}function ot(t,n){return n??{x:t.x,y:t.y}}function st(){return navigator.maxTouchPoints||"ontouchstart"in this}function Bt(){var t=ut,n=at,e=ot,o=st,i={},u=V("start","drag","end"),h=0,c,v,g,p,_=0;function y(r){r.on("mousedown.drag",l).filter(o).on("touchstart.drag",a).on("touchmove.drag",f,nt).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(r,d){if(!(p||!t.call(this,r,d))){var b=w(this,n.call(this,r,d),r,d,"mouse");b&&(H(r.view).on("mousemove.drag",m,$).on("mouseup.drag",s,$),et(r.view),Y(r),g=!1,c=r.clientX,v=r.clientY,b("start",r))}}function m(r){if(B(r),!g){var d=r.clientX-c,b=r.clientY-v;g=d*d+b*b>_}i.mouse("drag",r)}function s(r){H(r.view).on("mousemove.drag mouseup.drag",null),rt(r.view,g),B(r),i.mouse("end",r)}function a(r,d){if(t.call(this,r,d)){var b=r.changedTouches,N=n.call(this,r,d),M=b.length,A,E;for(A=0;A<M;++A)(E=w(this,N,r,d,b[A].identifier,b[A]))&&(Y(r),E("start",r,b[A]))}}function f(r){var d=r.changedTouches,b=d.length,N,M;for(N=0;N<b;++N)(M=i[d[N].identifier])&&(B(r),M("drag",r,d[N]))}function x(r){var d=r.changedTouches,b=d.length,N,M;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),N=0;N<b;++N)(M=i[d[N].identifier])&&(Y(r),M("end",r,d[N]))}function w(r,d,b,N,M,A){var E=u.copy(),D=G(A||b,d),C,K,S;if((S=e.call(r,new F("beforestart",{sourceEvent:b,target:y,identifier:M,active:h,x:D[0],y:D[1],dx:0,dy:0,dispatch:E}),N))!=null)return C=S.x-D[0]||0,K=S.y-D[1]||0,function k(q,O,tt){var R=D,X;switch(q){case"start":i[M]=k,X=h++;break;case"end":delete i[M],--h;case"drag":D=G(tt||O,d),X=h;break}E.call(q,r,new F(q,{sourceEvent:O,subject:S,target:y,identifier:M,active:X,x:D[0]+C,y:D[1]+K,dx:D[0]-R[0],dy:D[1]-R[1],dispatch:E}),N)}}return y.filter=function(r){return arguments.length?(t=typeof r=="function"?r:P(!!r),y):t},y.container=function(r){return arguments.length?(n=typeof r=="function"?r:P(r),y):n},y.subject=function(r){return arguments.length?(e=typeof r=="function"?r:P(r),y):e},y.touchable=function(r){return arguments.length?(o=typeof r=="function"?r:P(!!r),y):o},y.on=function(){var r=u.on.apply(u,arguments);return r===u?y:r},y.clickDistance=function(r){return arguments.length?(_=(r=+r)*r,y):Math.sqrt(_)},y}function Ft(t,n){var e,o=1;t==null&&(t=0),n==null&&(n=0);function i(){var u,h=e.length,c,v=0,g=0;for(u=0;u<h;++u)c=e[u],v+=c.x,g+=c.y;for(v=(v/h-t)*o,g=(g/h-n)*o,u=0;u<h;++u)c=e[u],c.x-=v,c.y-=g}return i.initialize=function(u){e=u},i.x=function(u){return arguments.length?(t=+u,i):t},i.y=function(u){return arguments.length?(n=+u,i):n},i.strength=function(u){return arguments.length?(o=+u,i):o},i}function ft(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return W(this.cover(n,e),n,e,t)}function W(t,n,e,o){if(isNaN(n)||isNaN(e))return t;var i,u=t._root,h={data:o},c=t._x0,v=t._y0,g=t._x1,p=t._y1,_,y,l,m,s,a,f,x;if(!u)return t._root=h,t;for(;u.length;)if((s=n>=(_=(c+g)/2))?c=_:g=_,(a=e>=(y=(v+p)/2))?v=y:p=y,i=u,!(u=u[f=a<<1|s]))return i[f]=h,t;if(l=+t._x.call(null,u.data),m=+t._y.call(null,u.data),n===l&&e===m)return h.next=u,i?i[f]=h:t._root=h,t;do i=i?i[f]=new Array(4):t._root=new Array(4),(s=n>=(_=(c+g)/2))?c=_:g=_,(a=e>=(y=(v+p)/2))?v=y:p=y;while((f=a<<1|s)===(x=(m>=y)<<1|l>=_));return i[x]=u,i[f]=h,t}function lt(t){var n,e,o=t.length,i,u,h=new Array(o),c=new Array(o),v=1/0,g=1/0,p=-1/0,_=-1/0;for(e=0;e<o;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(u=+this._y.call(null,n))||(h[e]=i,c[e]=u,i<v&&(v=i),i>p&&(p=i),u<g&&(g=u),u>_&&(_=u));if(v>p||g>_)return this;for(this.cover(v,g).cover(p,_),e=0;e<o;++e)W(this,h[e],c[e],t[e]);return this}function ht(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,o=this._y0,i=this._x1,u=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,u=(o=Math.floor(n))+1;else{for(var h=i-e||1,c=this._root,v,g;e>t||t>=i||o>n||n>=u;)switch(g=(n<o)<<1|t<e,v=new Array(4),v[g]=c,c=v,h*=2,g){case 0:i=e+h,u=o+h;break;case 1:e=i-h,u=o+h;break;case 2:i=e+h,o=u-h;break;case 3:e=i-h,o=u-h;break}this._root&&this._root.length&&(this._root=c)}return this._x0=e,this._y0=o,this._x1=i,this._y1=u,this}function ct(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function gt(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function j(t,n,e,o,i){this.node=t,this.x0=n,this.y0=e,this.x1=o,this.y1=i}function yt(t,n,e){var o,i=this._x0,u=this._y0,h,c,v,g,p=this._x1,_=this._y1,y=[],l=this._root,m,s;for(l&&y.push(new j(l,i,u,p,_)),e==null?e=1/0:(i=t-e,u=n-e,p=t+e,_=n+e,e*=e);m=y.pop();)if(!(!(l=m.node)||(h=m.x0)>p||(c=m.y0)>_||(v=m.x1)<i||(g=m.y1)<u))if(l.length){var a=(h+v)/2,f=(c+g)/2;y.push(new j(l[3],a,f,v,g),new j(l[2],h,f,a,g),new j(l[1],a,c,v,f),new j(l[0],h,c,a,f)),(s=(n>=f)<<1|t>=a)&&(m=y[y.length-1],y[y.length-1]=y[y.length-1-s],y[y.length-1-s]=m)}else{var x=t-+this._x.call(null,l.data),w=n-+this._y.call(null,l.data),r=x*x+w*w;if(r<e){var d=Math.sqrt(e=r);i=t-d,u=n-d,p=t+d,_=n+d,o=l.data}}return o}function xt(t){if(isNaN(p=+this._x.call(null,t))||isNaN(_=+this._y.call(null,t)))return this;var n,e=this._root,o,i,u,h=this._x0,c=this._y0,v=this._x1,g=this._y1,p,_,y,l,m,s,a,f;if(!e)return this;if(e.length)for(;;){if((m=p>=(y=(h+v)/2))?h=y:v=y,(s=_>=(l=(c+g)/2))?c=l:g=l,n=e,!(e=e[a=s<<1|m]))return this;if(!e.length)break;(n[a+1&3]||n[a+2&3]||n[a+3&3])&&(o=n,f=a)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(u=e.next)&&delete e.next,i?(u?i.next=u:delete i.next,this):n?(u?n[a]=u:delete n[a],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(o?o[f]=e:this._root=e),this):(this._root=u,this)}function vt(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function pt(){return this._root}function dt(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function mt(t){var n=[],e,o=this._root,i,u,h,c,v;for(o&&n.push(new j(o,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(o=e.node,u=e.x0,h=e.y0,c=e.x1,v=e.y1)&&o.length){var g=(u+c)/2,p=(h+v)/2;(i=o[3])&&n.push(new j(i,g,p,c,v)),(i=o[2])&&n.push(new j(i,u,p,g,v)),(i=o[1])&&n.push(new j(i,g,h,c,p)),(i=o[0])&&n.push(new j(i,u,h,g,p))}return this}function _t(t){var n=[],e=[],o;for(this._root&&n.push(new j(this._root,this._x0,this._y0,this._x1,this._y1));o=n.pop();){var i=o.node;if(i.length){var u,h=o.x0,c=o.y0,v=o.x1,g=o.y1,p=(h+v)/2,_=(c+g)/2;(u=i[0])&&n.push(new j(u,h,c,p,_)),(u=i[1])&&n.push(new j(u,p,c,v,_)),(u=i[2])&&n.push(new j(u,h,_,p,g)),(u=i[3])&&n.push(new j(u,p,_,v,g))}e.push(o)}for(;o=e.pop();)t(o.node,o.x0,o.y0,o.x1,o.y1);return this}function wt(t){return t[0]}function bt(t){return arguments.length?(this._x=t,this):this._x}function Nt(t){return t[1]}function Mt(t){return arguments.length?(this._y=t,this):this._y}function Z(t,n,e){var o=new Q(n??wt,e??Nt,NaN,NaN,NaN,NaN);return t==null?o:o.addAll(t)}function Q(t,n,e,o,i,u){this._x=t,this._y=n,this._x0=e,this._y0=o,this._x1=i,this._y1=u,this._root=void 0}function J(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var T=Z.prototype=Q.prototype;T.copy=function(){var t=new Q(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,o;if(!n)return t;if(!n.length)return t._root=J(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(o=n.source[i])&&(o.length?e.push({source:o,target:n.target[i]=new Array(4)}):n.target[i]=J(o));return t};T.add=ft;T.addAll=lt;T.cover=ht;T.data=ct;T.extent=gt;T.find=yt;T.remove=xt;T.removeAll=vt;T.root=pt;T.size=dt;T.visit=mt;T.visitAfter=_t;T.x=bt;T.y=Mt;function I(t){return function(){return t}}function z(t){return(t()-.5)*1e-6}function At(t){return t.index}function L(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function Qt(t){var n=At,e=_,o,i=I(30),u,h,c,v,g,p=1;t==null&&(t=[]);function _(a){return 1/Math.min(c[a.source.index],c[a.target.index])}function y(a){for(var f=0,x=t.length;f<p;++f)for(var w=0,r,d,b,N,M,A,E;w<x;++w)r=t[w],d=r.source,b=r.target,N=b.x+b.vx-d.x-d.vx||z(g),M=b.y+b.vy-d.y-d.vy||z(g),A=Math.sqrt(N*N+M*M),A=(A-u[w])/A*a*o[w],N*=A,M*=A,b.vx-=N*(E=v[w]),b.vy-=M*E,d.vx+=N*(E=1-E),d.vy+=M*E}function l(){if(h){var a,f=h.length,x=t.length,w=new Map(h.map((d,b)=>[n(d,b,h),d])),r;for(a=0,c=new Array(f);a<x;++a)r=t[a],r.index=a,typeof r.source!="object"&&(r.source=L(w,r.source)),typeof r.target!="object"&&(r.target=L(w,r.target)),c[r.source.index]=(c[r.source.index]||0)+1,c[r.target.index]=(c[r.target.index]||0)+1;for(a=0,v=new Array(x);a<x;++a)r=t[a],v[a]=c[r.source.index]/(c[r.source.index]+c[r.target.index]);o=new Array(x),m(),u=new Array(x),s()}}function m(){if(h)for(var a=0,f=t.length;a<f;++a)o[a]=+e(t[a],a,t)}function s(){if(h)for(var a=0,f=t.length;a<f;++a)u[a]=+i(t[a],a,t)}return y.initialize=function(a,f){h=a,g=f,l()},y.links=function(a){return arguments.length?(t=a,l(),y):t},y.id=function(a){return arguments.length?(n=a,y):n},y.iterations=function(a){return arguments.length?(p=+a,y):p},y.strength=function(a){return arguments.length?(e=typeof a=="function"?a:I(+a),m(),y):e},y.distance=function(a){return arguments.length?(i=typeof a=="function"?a:I(+a),s(),y):i},y}const jt=1664525,Tt=1013904223,U=4294967296;function Et(){let t=1;return()=>(t=(jt*t+Tt)%U)/U}function Dt(t){return t.x}function zt(t){return t.y}var It=10,St=Math.PI*(3-Math.sqrt(5));function Ct(t){var n,e=1,o=.001,i=1-Math.pow(o,1/300),u=0,h=.6,c=new Map,v=it(_),g=V("tick","end"),p=Et();t==null&&(t=[]);function _(){y(),g.call("tick",n),e<o&&(v.stop(),g.call("end",n))}function y(s){var a,f=t.length,x;s===void 0&&(s=1);for(var w=0;w<s;++w)for(e+=(u-e)*i,c.forEach(function(r){r(e)}),a=0;a<f;++a)x=t[a],x.fx==null?x.x+=x.vx*=h:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=h:(x.y=x.fy,x.vy=0);return n}function l(){for(var s=0,a=t.length,f;s<a;++s){if(f=t[s],f.index=s,f.fx!=null&&(f.x=f.fx),f.fy!=null&&(f.y=f.fy),isNaN(f.x)||isNaN(f.y)){var x=It*Math.sqrt(.5+s),w=s*St;f.x=x*Math.cos(w),f.y=x*Math.sin(w)}(isNaN(f.vx)||isNaN(f.vy))&&(f.vx=f.vy=0)}}function m(s){return s.initialize&&s.initialize(t,p),s}return l(),n={tick:y,restart:function(){return v.restart(_),n},stop:function(){return v.stop(),n},nodes:function(s){return arguments.length?(t=s,l(),c.forEach(m),n):t},alpha:function(s){return arguments.length?(e=+s,n):e},alphaMin:function(s){return arguments.length?(o=+s,n):o},alphaDecay:function(s){return arguments.length?(i=+s,n):+i},alphaTarget:function(s){return arguments.length?(u=+s,n):u},velocityDecay:function(s){return arguments.length?(h=1-s,n):1-h},randomSource:function(s){return arguments.length?(p=s,c.forEach(m),n):p},force:function(s,a){return arguments.length>1?(a==null?c.delete(s):c.set(s,m(a)),n):c.get(s)},find:function(s,a,f){var x=0,w=t.length,r,d,b,N,M;for(f==null?f=1/0:f*=f,x=0;x<w;++x)N=t[x],r=s-N.x,d=a-N.y,b=r*r+d*d,b<f&&(M=N,f=b);return M},on:function(s,a){return arguments.length>1?(g.on(s,a),n):g.on(s)}}}function Kt(){var t,n,e,o,i=I(-30),u,h=1,c=1/0,v=.81;function g(l){var m,s=t.length,a=Z(t,Dt,zt).visitAfter(_);for(o=l,m=0;m<s;++m)n=t[m],a.visit(y)}function p(){if(t){var l,m=t.length,s;for(u=new Array(m),l=0;l<m;++l)s=t[l],u[s.index]=+i(s,l,t)}}function _(l){var m=0,s,a,f=0,x,w,r;if(l.length){for(x=w=r=0;r<4;++r)(s=l[r])&&(a=Math.abs(s.value))&&(m+=s.value,f+=a,x+=a*s.x,w+=a*s.y);l.x=x/f,l.y=w/f}else{s=l,s.x=s.data.x,s.y=s.data.y;do m+=u[s.data.index];while(s=s.next)}l.value=m}function y(l,m,s,a){if(!l.value)return!0;var f=l.x-n.x,x=l.y-n.y,w=a-m,r=f*f+x*x;if(w*w/v<r)return r<c&&(f===0&&(f=z(e),r+=f*f),x===0&&(x=z(e),r+=x*x),r<h&&(r=Math.sqrt(h*r)),n.vx+=f*l.value*o/r,n.vy+=x*l.value*o/r),!0;if(l.length||r>=c)return;(l.data!==n||l.next)&&(f===0&&(f=z(e),r+=f*f),x===0&&(x=z(e),r+=x*x),r<h&&(r=Math.sqrt(h*r)));do l.data!==n&&(w=u[l.data.index]*o/r,n.vx+=f*w,n.vy+=x*w);while(l=l.next)}return g.initialize=function(l,m){t=l,e=m,p()},g.strength=function(l){return arguments.length?(i=typeof l=="function"?l:I(+l),p(),g):i},g.distanceMin=function(l){return arguments.length?(h=l*l,g):Math.sqrt(h)},g.distanceMax=function(l){return arguments.length?(c=l*l,g):Math.sqrt(c)},g.theta=function(l){return arguments.length?(v=l*l,g):Math.sqrt(v)},g}export{Kt as a,I as b,Ft as c,Bt as d,z as j,Qt as l,Yt as m,Z as q,Ct as s};
