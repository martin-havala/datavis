import{S as ce,i as fe,s as he,k as ue,J as w,q as T,l as _e,m as k,K as M,h as y,r as I,n as u,p as F,b as de,H as p,C as zt,o as pe,w as ge}from"../chunks/index.0cb42cb9.js";import"../chunks/transform.f0a34255.js";import{c as xe}from"../chunks/csv.41e40aac.js";import{s as me}from"../chunks/select.84cbef7e.js";import{e as ve}from"../chunks/extent.4cf1c809.js";import{b as ye,a as oe}from"../chunks/ticks.39a2651d.js";import{m as Zt}from"../chunks/max.adfc8a60.js";import{l as te}from"../chunks/line.16a03edc.js";import{e as ee}from"../chunks/math.562eee72.js";const Ee=ke(we);function ke(t){return function(n,a,i=a){if(!((a=+a)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:r,width:l,height:h}=n;if(!((l=Math.floor(l))>=0))throw new RangeError("invalid width");if(!((h=Math.floor(h!==void 0?h:r.length/l))>=0))throw new RangeError("invalid height");if(!l||!h||!a&&!i)return n;const m=a&&t(a),g=i&&t(i),o=r.slice();return m&&g?(et(m,o,r,l,h),et(m,r,o,l,h),et(m,o,r,l,h),nt(g,r,o,l,h),nt(g,o,r,l,h),nt(g,r,o,l,h)):m?(et(m,r,o,l,h),et(m,o,r,l,h),et(m,r,o,l,h)):g&&(nt(g,r,o,l,h),nt(g,o,r,l,h),nt(g,r,o,l,h)),n}}function et(t,n,a,i,r){for(let l=0,h=i*r;l<h;)t(n,a,l,l+=i,1)}function nt(t,n,a,i,r){for(let l=0,h=i*r;l<i;++l)t(n,a,l,l+h,i)}function we(t){const n=Math.floor(t);if(n===t)return Me(t);const a=t-n,i=2*t+1;return(r,l,h,m,g)=>{if(!((m-=g)>=h))return;let o=n*l[h];const f=g*n,E=f+g;for(let d=h,c=h+f;d<c;d+=g)o+=l[Math.min(m,d)];for(let d=h,c=m;d<=c;d+=g)o+=l[Math.min(m,d+f)],r[d]=(o+a*(l[Math.max(h,d-E)]+l[Math.min(m,d+E)]))/i,o-=l[Math.max(h,d-f)]}}function Me(t){const n=2*t+1;return(a,i,r,l,h)=>{if(!((l-=h)>=r))return;let m=t*i[r];const g=h*t;for(let o=r,f=r+g;o<f;o+=h)m+=i[Math.min(l,o)];for(let o=r,f=l;o<=f;o+=h)m+=i[Math.min(l,o+g)],a[o]=m/n,m-=i[Math.max(r,o-g)]}}function be(t,n){let a=0;if(n===void 0)for(let i of t)i!=null&&(i=+i)>=i&&++a;else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(r=+r)>=r&&++a}return a}function Ae(t,n,a){let i;for(;;){const r=ye(t,n,a);if(r===i||r===0||!isFinite(r))return[t,n];r>0?(t=Math.floor(t/r)*r,n=Math.ceil(n/r)*r):r<0&&(t=Math.ceil(t*r)/r,n=Math.floor(n*r)/r),i=r}}function Re(t){return Math.max(1,Math.ceil(Math.log(be(t))/Math.LN2)+1)}function ne(t,n){let a=0,i=0;if(n===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(++a,i+=r);else{let r=-1;for(let l of t)(l=n(l,++r,t))!=null&&(l=+l)>=l&&(++a,i+=l)}if(a)return i/a}var Ne=Array.prototype,se=Ne.slice;function ze(t,n){return t-n}function Le(t){for(var n=0,a=t.length,i=t[a-1][1]*t[0][0]-t[a-1][0]*t[0][1];++n<a;)i+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return i}const Y=t=>()=>t;function $e(t,n){for(var a=-1,i=n.length,r;++a<i;)if(r=Ce(t,n[a]))return r;return 0}function Ce(t,n){for(var a=n[0],i=n[1],r=-1,l=0,h=t.length,m=h-1;l<h;m=l++){var g=t[l],o=g[0],f=g[1],E=t[m],d=E[0],c=E[1];if(je(g,E,n))return 0;f>i!=c>i&&a<(d-o)*(i-f)/(c-f)+o&&(r=-r)}return r}function je(t,n,a){var i;return Pe(t,n,a)&&Te(t[i=+(t[0]===n[0])],a[i],n[i])}function Pe(t,n,a){return(n[0]-t[0])*(a[1]-t[1])===(a[0]-t[0])*(n[1]-t[1])}function Te(t,n,a){return t<=n&&n<=a||a<=n&&n<=t}function Ie(){}var H=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function re(){var t=1,n=1,a=Re,i=g;function r(o){var f=a(o);if(Array.isArray(f))f=f.slice().sort(ze);else{const E=ve(o,Be);for(f=oe(...Ae(E[0],E[1],f),f);f[f.length-1]>=E[1];)f.pop();for(;f[1]<E[0];)f.shift()}return f.map(E=>l(o,E))}function l(o,f){const E=f==null?NaN:+f;if(isNaN(E))throw new Error(`invalid value: ${f}`);var d=[],c=[];return h(o,E,function(x){i(x,o,E),Le(x)>0?d.push([x]):c.push(x)}),c.forEach(function(x){for(var v=0,A=d.length,z;v<A;++v)if($e((z=d[v])[0],x)!==-1){z.push(x);return}}),{type:"MultiPolygon",value:f,coordinates:d}}function h(o,f,E){var d=new Array,c=new Array,x,v,A,z,s,R;for(x=v=-1,z=K(o[0],f),H[z<<1].forEach(N);++x<t-1;)A=z,z=K(o[x+1],f),H[A|z<<1].forEach(N);for(H[z<<0].forEach(N);++v<n-1;){for(x=-1,z=K(o[v*t+t],f),s=K(o[v*t],f),H[z<<1|s<<2].forEach(N);++x<t-1;)A=z,z=K(o[v*t+t+x+1],f),R=s,s=K(o[v*t+x+1],f),H[A|z<<1|s<<2|R<<3].forEach(N);H[z|s<<3].forEach(N)}for(x=-1,s=o[v*t]>=f,H[s<<2].forEach(N);++x<t-1;)R=s,s=K(o[v*t+x+1],f),H[s<<2|R<<3].forEach(N);H[s<<3].forEach(N);function N(b){var L=[b[0][0]+x,b[0][1]+v],$=[b[1][0]+x,b[1][1]+v],C=m(L),j=m($),e,_;(e=c[C])?(_=d[j])?(delete c[e.end],delete d[_.start],e===_?(e.ring.push($),E(e.ring)):d[e.start]=c[_.end]={start:e.start,end:_.end,ring:e.ring.concat(_.ring)}):(delete c[e.end],e.ring.push($),c[e.end=j]=e):(e=d[j])?(_=c[C])?(delete d[e.start],delete c[_.end],e===_?(e.ring.push($),E(e.ring)):d[_.start]=c[e.end]={start:_.start,end:e.end,ring:_.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(L),d[e.start=C]=e):d[C]=c[j]={start:C,end:j,ring:[L,$]}}}function m(o){return o[0]*2+o[1]*(t+1)*4}function g(o,f,E){o.forEach(function(d){var c=d[0],x=d[1],v=c|0,A=x|0,z=Lt(f[A*t+v]);c>0&&c<t&&v===c&&(d[0]=ae(c,Lt(f[A*t+v-1]),z,E)),x>0&&x<n&&A===x&&(d[1]=ae(x,Lt(f[(A-1)*t+v]),z,E))})}return r.contour=l,r.size=function(o){if(!arguments.length)return[t,n];var f=Math.floor(o[0]),E=Math.floor(o[1]);if(!(f>=0&&E>=0))throw new Error("invalid size");return t=f,n=E,r},r.thresholds=function(o){return arguments.length?(a=typeof o=="function"?o:Array.isArray(o)?Y(se.call(o)):Y(o),r):a},r.smooth=function(o){return arguments.length?(i=o?g:Ie,r):i===g},r}function Be(t){return isFinite(t)?t:NaN}function K(t,n){return t==null?!1:+t>=n}function Lt(t){return t==null||isNaN(t=+t)?-1/0:t}function ae(t,n,a,i){const r=i-n,l=a-n,h=isFinite(r)||isFinite(l)?r/l:Math.sign(r)/Math.sign(l);return isNaN(h)?t:t+h-.5}function Fe(t){return t[0]}function Oe(t){return t[1]}function We(){return 1}function De(){var t=Fe,n=Oe,a=We,i=960,r=500,l=20,h=2,m=l*3,g=i+m*2>>h,o=r+m*2>>h,f=Y(20);function E(s){var R=new Float32Array(g*o),N=Math.pow(2,-h),b=-1;for(const B of s){var L=(t(B,++b,s)+m)*N,$=(n(B,b,s)+m)*N,C=+a(B,b,s);if(C&&L>=0&&L<g&&$>=0&&$<o){var j=Math.floor(L),e=Math.floor($),_=L-j-.5,P=$-e-.5;R[j+e*g]+=(1-_)*(1-P)*C,R[j+1+e*g]+=_*(1-P)*C,R[j+1+(e+1)*g]+=_*P*C,R[j+(e+1)*g]+=(1-_)*P*C}}return Ee({data:R,width:g,height:o},l*N),R}function d(s){var R=E(s),N=f(R),b=Math.pow(2,2*h);return Array.isArray(N)||(N=oe(Number.MIN_VALUE,Zt(R)/b,N)),re().size([g,o]).thresholds(N.map(L=>L*b))(R).map((L,$)=>(L.value=+N[$],c(L)))}d.contours=function(s){var R=E(s),N=re().size([g,o]),b=Math.pow(2,2*h),L=$=>{$=+$;var C=c(N.contour(R,$*b));return C.value=$,C};return Object.defineProperty(L,"max",{get:()=>Zt(R)/b}),L};function c(s){return s.coordinates.forEach(x),s}function x(s){s.forEach(v)}function v(s){s.forEach(A)}function A(s){s[0]=s[0]*Math.pow(2,h)-m,s[1]=s[1]*Math.pow(2,h)-m}function z(){return m=l*3,g=i+m*2>>h,o=r+m*2>>h,d}return d.x=function(s){return arguments.length?(t=typeof s=="function"?s:Y(+s),d):t},d.y=function(s){return arguments.length?(n=typeof s=="function"?s:Y(+s),d):n},d.weight=function(s){return arguments.length?(a=typeof s=="function"?s:Y(+s),d):a},d.size=function(s){if(!arguments.length)return[i,r];var R=+s[0],N=+s[1];if(!(R>=0&&N>=0))throw new Error("invalid size");return i=R,r=N,z()},d.cellSize=function(s){if(!arguments.length)return 1<<h;if(!((s=+s)>=1))throw new Error("invalid cell size");return h=Math.floor(Math.log(s)/Math.LN2),z()},d.thresholds=function(s){return arguments.length?(f=typeof s=="function"?s:Array.isArray(s)?Y(se.call(s)):Y(s),d):f},d.bandwidth=function(s){if(!arguments.length)return Math.sqrt(l*(l+1));if(!((s=+s)>=0))throw new Error("invalid bandwidth");return l=(Math.sqrt(4*s*s+1)-1)/2,z()},d}function ie(t,n,a){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-a),t._x2,t._y2)}function $t(t,n){this._context=t,this._k=(1-n)/6}$t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ie(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:ie(this,t,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};(function t(n){function a(i){return new $t(i,n)}return a.tension=function(i){return t(+i)},a})(0);function He(t,n,a){var i=t._x1,r=t._y1,l=t._x2,h=t._y2;if(t._l01_a>ee){var m=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,g=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*m-t._x0*t._l12_2a+t._x2*t._l01_2a)/g,r=(r*m-t._y0*t._l12_2a+t._y2*t._l01_2a)/g}if(t._l23_a>ee){var o=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);l=(l*o+t._x1*t._l23_2a-n*t._l12_2a)/f,h=(h*o+t._y1*t._l23_2a-a*t._l12_2a)/f}t._context.bezierCurveTo(i,r,l,h,t._x2,t._y2)}function le(t,n){this._context=t,this._alpha=n}le.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var a=this._x2-t,i=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:He(this,t,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};const Se=function t(n){function a(i){return n?new le(i,n):new $t(i,0)}return a.alpha=function(i){return t(+i)},a}(.5);function Ue(t){let n,a,i,r,l,h,m,g,o,f,E,d,c,x,v,A,z,s,R,N,b,L,$,C,j,e,_,P,B,O,D,rt,pt,S,at,it,gt,U,G,ot,xt,q,st,mt,J,lt,vt,V,Q,ct,yt,X,Z,ft,Et;return{c(){n=ue("section"),a=w("svg"),i=w("defs"),r=w("marker"),l=w("path"),h=w("g"),m=w("text"),g=w("textPath"),o=T("alive people by rank"),f=w("g"),E=w("text"),d=T("Oldest living people"),c=w("text"),x=T("Verified list of the oldest people"),v=w("text"),A=w("a"),z=T("datasources: wikipedia"),s=w("text"),R=w("a"),N=T("clio-infra"),b=w("g"),L=w("g"),$=w("path"),C=w("text"),j=T("male"),e=w("g"),_=w("path"),P=w("text"),B=T("female "),O=w("g"),D=w("path"),rt=w("text"),pt=T("alive"),S=w("g"),at=w("path"),it=w("text"),gt=T("deceased"),U=w("g"),G=w("path"),ot=w("text"),xt=T("world average"),q=w("g"),st=w("text"),mt=T("life expectancy"),J=w("g"),lt=w("text"),vt=T("per country:"),V=w("g"),Q=w("circle"),ct=w("text"),yt=T("at birth"),X=w("g"),Z=w("circle"),ft=w("text"),Et=T("recent"),this.h()},l(ht){n=_e(ht,"SECTION",{});var _t=k(n);a=M(_t,"svg",{viewBox:!0,"xmlns:xlink":!0,class:!0});var ut=k(a);i=M(ut,"defs",{});var Ct=k(i);r=M(Ct,"marker",{id:!0,viewBox:!0,refX:!0,refY:!0,markerUnits:!0,markerWidth:!0,markerHeight:!0,orient:!0});var jt=k(r);l=M(jt,"path",{d:!0,style:!0}),k(l).forEach(y),jt.forEach(y),Ct.forEach(y),h=M(ut,"g",{}),k(h).forEach(y),m=M(ut,"text",{style:!0});var Pt=k(m);g=M(Pt,"textPath",{href:!0,startOffset:!0,"text-anchor":!0});var Tt=k(g);o=I(Tt,"alive people by rank"),Tt.forEach(y),Pt.forEach(y),f=M(ut,"g",{class:!0,transform:!0});var tt=k(f);E=M(tt,"text",{x:!0,y:!0,style:!0});var It=k(E);d=I(It,"Oldest living people"),It.forEach(y),c=M(tt,"text",{x:!0,y:!0,style:!0});var Bt=k(c);x=I(Bt,"Verified list of the oldest people"),Bt.forEach(y),v=M(tt,"text",{x:!0,y:!0,style:!0});var Ft=k(v);A=M(Ft,"a",{href:!0});var Ot=k(A);z=I(Ot,"datasources: wikipedia"),Ot.forEach(y),Ft.forEach(y),s=M(tt,"text",{x:!0,y:!0,style:!0});var Wt=k(s);R=M(Wt,"a",{href:!0});var Dt=k(R);N=I(Dt,"clio-infra"),Dt.forEach(y),Wt.forEach(y),b=M(tt,"g",{transform:!0});var W=k(b);L=M(W,"g",{class:!0,transform:!0});var kt=k(L);$=M(kt,"path",{d:!0,class:!0}),k($).forEach(y),C=M(kt,"text",{});var Ht=k(C);j=I(Ht,"male"),Ht.forEach(y),kt.forEach(y),e=M(W,"g",{class:!0,transform:!0});var wt=k(e);_=M(wt,"path",{d:!0,class:!0}),k(_).forEach(y),P=M(wt,"text",{});var St=k(P);B=I(St,"female "),St.forEach(y),wt.forEach(y),O=M(W,"g",{class:!0,transform:!0});var Mt=k(O);D=M(Mt,"path",{d:!0,class:!0}),k(D).forEach(y),rt=M(Mt,"text",{});var Ut=k(rt);pt=I(Ut,"alive"),Ut.forEach(y),Mt.forEach(y),S=M(W,"g",{class:!0,transform:!0});var bt=k(S);at=M(bt,"path",{d:!0}),k(at).forEach(y),it=M(bt,"text",{});var Vt=k(it);gt=I(Vt,"deceased"),Vt.forEach(y),bt.forEach(y),U=M(W,"g",{class:!0,transform:!0});var At=k(U);G=M(At,"path",{d:!0,class:!0}),k(G).forEach(y),ot=M(At,"text",{});var Xt=k(ot);xt=I(Xt,"world average"),Xt.forEach(y),At.forEach(y),q=M(W,"g",{class:!0,transform:!0});var Yt=k(q);st=M(Yt,"text",{});var qt=k(st);mt=I(qt,"life expectancy"),qt.forEach(y),Yt.forEach(y),J=M(W,"g",{class:!0,transform:!0});var Jt=k(J);lt=M(Jt,"text",{});var Kt=k(lt);vt=I(Kt,"per country:"),Kt.forEach(y),Jt.forEach(y),V=M(W,"g",{class:!0,transform:!0});var Rt=k(V);Q=M(Rt,"circle",{cx:!0,r:!0}),k(Q).forEach(y),ct=M(Rt,"text",{});var Gt=k(ct);yt=I(Gt,"at birth"),Gt.forEach(y),Rt.forEach(y),X=M(W,"g",{class:!0,transform:!0});var Nt=k(X);Z=M(Nt,"circle",{cx:!0,r:!0}),k(Z).forEach(y),ft=M(Nt,"text",{});var Qt=k(ft);Et=I(Qt,"recent"),Qt.forEach(y),Nt.forEach(y),W.forEach(y),tt.forEach(y),ut.forEach(y),_t.forEach(y),this.h()},h(){u(l,"d","M 0 0 L 10 5 L 0 10 z"),F(l,"fill","currentColor"),F(l,"fill-opacity","0.5"),u(r,"id","triangleMarker"),u(r,"viewBox","0 0 10 10"),u(r,"refX","1"),u(r,"refY","5"),u(r,"markerUnits","strokeWidth"),u(r,"markerWidth","10"),u(r,"markerHeight","10"),u(r,"orient","auto"),u(g,"href","#local_people_contours_rank2"),u(g,"startOffset","50%"),u(g,"text-anchor","middle"),F(m,"font-size",".9em"),F(m,"opacity","0.5"),u(E,"x","70"),u(E,"y","0"),F(E,"font-size","3em"),F(E,"text-anchor","end"),u(c,"x","70"),u(c,"y","50"),F(c,"font-size",".9em"),F(c,"text-anchor","end"),u(A,"href","https://en.wikipedia.org/wiki/List_of_verified_oldest_people"),u(v,"x","70"),u(v,"y","100"),F(v,"font-size",".8em"),F(v,"text-anchor","end"),u(R,"href","https://clio-infra.eu/Indicators/LifeExpectancyatBirthTotal.html"),u(s,"x","70"),u(s,"y","120"),F(s,"font-size",".8em"),F(s,"text-anchor","end"),u($,"d","M0,0 h27"),u($,"class","person_contour alive"),u(L,"class","male alive"),u(L,"transform","translate(0, 120)"),u(_,"d","M0,0 h27"),u(_,"class","person_contour alive"),u(e,"class","female alive"),u(e,"transform","translate(0, 140)"),u(D,"d","M0,0 h27"),u(D,"class","person_contour alive"),u(O,"class","alive"),u(O,"transform","translate(0, 180)"),u(at,"d","M0,0 h27"),u(S,"class","person_contour deceased"),u(S,"transform","translate(0, 200)"),u(G,"d","M0,0 h27"),u(G,"class","average"),u(U,"class","avg_contour"),u(U,"transform","translate(0, 240)"),u(q,"class","expectation"),u(q,"transform","translate(-35, 280)"),u(J,"class","expectation"),u(J,"transform","translate(-35, 295)"),u(Q,"cx","13.5"),u(Q,"r","3"),u(V,"class","expectation birth"),u(V,"transform","translate(0, 320)"),u(Z,"cx","13.5"),u(Z,"r","3"),u(X,"class","expectation recent"),u(X,"transform","translate(0, 340)"),u(b,"transform","translate(-10, 50)"),u(f,"class","side_legend"),u(f,"transform","translate(680, 50)"),u(a,"viewBox","0 0 800 800"),u(a,"xmlns:xlink","http://www.w3.org/1999/xlink"),u(a,"class","svelte-177xle8")},m(ht,_t){de(ht,n,_t),p(n,a),p(a,i),p(i,r),p(r,l),p(a,h),t[2](h),p(a,m),p(m,g),p(g,o),p(a,f),p(f,E),p(E,d),p(f,c),p(c,x),p(f,v),p(v,A),p(A,z),p(f,s),p(s,R),p(R,N),p(f,b),p(b,L),p(L,$),p(L,C),p(C,j),p(b,e),p(e,_),p(e,P),p(P,B),p(b,O),p(O,D),p(O,rt),p(rt,pt),p(b,S),p(S,at),p(S,it),p(it,gt),p(b,U),p(U,G),p(U,ot),p(ot,xt),p(b,q),p(q,st),p(st,mt),p(b,J),p(J,lt),p(lt,vt),p(b,V),p(V,Q),p(V,ct),p(ct,yt),p(b,X),p(X,Z),p(X,ft),p(ft,Et)},p:zt,i:zt,o:zt,d(ht){ht&&y(n),t[2](null)}}}function dt(t,n,a=7){t.append("text").attr("class","label").attr("transform",`translate(${a},0)`).text(n),t.append("circle").attr("r",3),a>15&&t.append("path").attr("class","label__line").attr("d",`M0,0 h${a-5}`)}function Ve(t,n,a){let{data:i}=n;const r=xe(i.centenarians).map(c=>({...c,age:Math.floor(c.age)})),l=r.reduce((c,x)=>c.find(v=>v.age==x.age&&v.gender==x.gender&&v.still_alive==x.still_alive)?c:[...c,x],[]),h=(c,x)=>{const v=x*(Math.PI/180),A=c[0]+5e3*Math.cos(v),z=c[1]-5e3*Math.sin(v);return[c,[A,z]]},m=[{gender:"male",age:70,label:"average"},{gender:"female",age:75,label:"average"}],g=[{x:99,y:800},{x:138,y:900},{x:164,y:711},{x:174,y:653},{x:167,y:591},{x:142,y:529},{x:99,y:500},{x:39,y:470},{x:-35,y:382},{x:-124,y:359},{x:-224,y:679}];let o,f;const E=([[c,x],[v,A]],[[z,s],[R,N]])=>{let b,L,$;return b=(v-c)*(N-s)-(R-z)*(A-x),b===0?null:($=((N-s)*(R-c)+(z-R)*(N-x))/b,L=((x-A)*(R-c)+(v-c)*(N-x))/b,0<$&&$<1&&0<L&&L<1?[c+(v-c)*$,x+(A-x)*$]:null)};pe(()=>{f=me(o);{const e={male:1,female:1,abs:1};r.forEach(_=>{_.still_alive==="alive"&&(_.aliveRank=e[_.gender]++,_.aliveRankAbs=e.abs++)})}const c=De().size([800,800]).cellSize(30).bandwidth(186).thresholds(180).x(({x:e})=>e).y(({y:e})=>e)(g).reverse().map(e=>e.coordinates).flat(2).slice(0,160).map(e=>[...e]),x=te().curve(Se).x(e=>e[0]).y(e=>e[1]);f.append("g").attr("class","contours").selectAll("g").data(c.filter((e,_)=>_%5==0&&_<121)).join("path").attr("class","contour").attr("d",x);const v=[ne(c[0].map(e=>e[0])),ne(c[0].map(e=>e[1]))],A=(e,_=0)=>{const P=h(v,_);for(let B=0;B<e.length-1;B++){const O=[e[B],e[B+1]],D=E(P,O);if(D)return D}return null},z=l.map(e=>({centenarian:e,path:c[Math.floor(e.age)]}));f.append("g").attr("class","person_contours").selectAll("g").data(z).join("g").attr("class",e=>`person_contour ${e.centenarian.still_alive} ${e.centenarian.gender} ${e.centenarian.aliveRank==1?"oldest":""}`).append("path").attr("d",e=>x(e.path));const R=m.map(e=>({grp:e,path:c[Math.floor(e.age)]}));f.selectAll("g.avg_contours").data(R).join("g").attr("class",e=>`avg_contour ${e.grp.gender}`).append("path").attr("d",e=>x(e.path));const b=f.append("g").attr("class","people_contours_labels").selectAll("g").data(r.filter(e=>!!e.aliveRank)).join("g").attr("class",e=>`${e.gender} expectation`);dt(b.append("g").attr("transform",e=>{var _;return`translate(${(_=A(c[e.age],80-8*(e.aliveRankAbs??0)))==null?void 0:_.join()})`}),e=>e.aliveRank?`${e.name}`:"",12);const L=b.append("g").attr("class","expectation");L.append("path").attr("d",e=>{var _,P;return`M${(_=A(c[0],80-8*(e.aliveRankAbs??0)))==null?void 0:_.join()} L${(P=A(c[e.age],80-8*(e.aliveRankAbs??0)))==null?void 0:P.join()}`}),dt(L.append("g").attr("class","expectation birth label").attr("transform",e=>{var _;return e.birth_exp?`translate(${(_=A(c[Math.round(e.birth_exp)],80-8*(e.aliveRankAbs??0)))==null?void 0:_.join()})`:""}),e=>`${(+(e.birth_exp??0)).toFixed(1)}`,12),dt(L.append("g").attr("class","recent label").attr("transform",e=>{var _;return e.birth_exp?`translate(${(_=A(c[Math.round(e.exp_recent)],80-8*(e.aliveRankAbs??0)))==null?void 0:_.join()})`:""}),e=>`${(+(e.exp_recent??0)).toFixed(1)}`,12);const $=te().x(e=>e[0]).y(e=>e[1]);f.selectAll("path#people_contours_rank").data([r.filter(e=>!!e.aliveRank)]).join("path").attr("id","people_contours_rank").style("marker-end","url(#triangleMarker)").attr("stroke","red").attr("d",e=>$(e.map(_=>A(c[130+2],67-(_.aliveRankAbs??0)*1.6)))),f.selectAll("defs").data([r.filter(e=>!!e.aliveRank)]).join("path").attr("id","local_people_contours_rank2").attr("display","none").attr("d",e=>$(e.map(_=>A(c[131+2],67-(_.aliveRankAbs??0)*1.6))));const C=c.filter((e,_)=>_%10==0&&_<130).map((e,_)=>A(e,86)),j=f.append("g").attr("class","legend").selectAll("g").data(C).join("g").attr("transform",e=>`translate(${e==null?void 0:e.join()})`).style("display",(e,_)=>_?"visible":"none");dt(j,(e,_)=>_*10)});function d(c){ge[c?"unshift":"push"](()=>{o=c,a(0,o)})}return t.$$set=c=>{"data"in c&&a(1,i=c.data)},[o,i,d]}class en extends ce{constructor(n){super(),fe(this,n,Ve,Ue,he,{data:1})}}export{en as default};
